<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AB Fit - App de Treino</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f7f7f7;
            --text-primary: #121212;
            --text-secondary: #555555;
            --accent-red: #e53e3e;
            --accent-green: #4CAF50;
            --accent-orange: #ff9800;
            --border-color: #e0e0e0;
        }
        
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
        }
        
        body { 
            background-color: var(--bg-secondary); 
            color: var(--text-primary); 
        }
        
        .login-screen { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            min-height: 100vh; 
            background-color: var(--bg-primary); 
            padding: 20px; 
        }
        
        .login-container { 
            background-color: var(--bg-primary); 
            border-radius: 15px; 
            padding: 30px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.1); 
            width: 100%; 
            max-width: 600px; 
            text-align: center; 
        }
        
        .logo { 
            max-width: 150px; 
            margin: 0 auto 25px auto; 
        }
        
        .login-prompt { 
            color: var(--text-primary); 
            font-size: 1.2rem; 
            font-weight: 500; 
            margin-bottom: 25px; 
        }
        
        .user-selection { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); 
            gap: 20px; 
        }
        
        .user-option { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            padding: 15px; 
            background-color: var(--bg-secondary); 
            border-radius: 10px; 
            cursor: pointer; 
            transition: all 0.3s; 
            border: 1px solid var(--border-color); 
        }
        
        .user-option:hover { 
            transform: translateY(-5px); 
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); 
            border-color: var(--accent-red); 
        }
        
        .user-photo { 
            width: 80px; 
            height: 80px; 
            border-radius: 50%; 
            object-fit: cover; 
            margin-bottom: 10px; 
            border: 2px solid var(--bg-primary); 
        }
        
        .user-name { 
            font-size: 1rem; 
            font-weight: 600; 
            color: var(--text-primary); 
            text-align: center; 
        }
        
        .main-screen { 
            display: none; 
        }
        
        header { 
            background-color: var(--bg-primary); 
            border-bottom: 1px solid var(--border-color); 
            color: var(--text-primary); 
            padding: 15px 20px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            position: sticky; 
            top: 0; 
            z-index: 1000; 
        }
        
        .user-info { 
            display: flex; 
            align-items: center; 
            gap: 10px; 
        }
        
        .user-info img { 
            width: 40px; 
            height: 40px; 
            border-radius: 50%; 
            object-fit: cover; 
            border: 2px solid var(--accent-red); 
        }
        
        .logout-btn { 
            color: var(--text-primary); 
            background: none; 
            border: none; 
            font-size: 1.2rem; 
            cursor: pointer; 
        }
        
        .main-content { 
            padding: 20px; 
        }
        
        .tab-navigation { 
            display: flex; 
            justify-content: space-around; 
            margin-bottom: 20px; 
            background-color: var(--bg-primary); 
            border-radius: 10px; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.05); 
            overflow: hidden; 
            position: sticky; 
            top: 70px; 
            z-index: 999; 
            border: 1px solid var(--border-color); 
        }
        
        .tab-button { 
            flex: 1; 
            padding: 15px 10px; 
            text-align: center; 
            background: none; 
            border: none; 
            font-weight: 600; 
            color: var(--text-secondary); 
            cursor: pointer; 
            transition: all 0.3s; 
            border-bottom: 3px solid transparent; 
        }
        
        .tab-button.active { 
            color: var(--accent-red); 
            border-bottom: 3px solid var(--accent-red); 
        }
        
        .tab-content { 
            display: none; 
        }
        
        .tab-content.active { 
            display: block; 
            animation: fadeIn 0.5s; 
        }
        
        @keyframes fadeIn { 
            from { opacity: 0; } 
            to { opacity: 1; } 
        }
        
        .card { 
            background-color: var(--bg-primary); 
            border: 1px solid var(--border-color); 
            padding: 20px; 
            margin-bottom: 20px; 
            border-radius: 10px; 
        }
        
        .card h2 { 
            color: var(--text-primary); 
            margin-bottom: 15px;
        }
        
        .card h2 i { 
            color: var(--accent-red); 
            margin-right: 10px;
        }
        
        .workout-folder { 
            background-color: var(--bg-secondary); 
            border-left: 4px solid var(--accent-red); 
            border-radius: 10px; 
            padding: 15px; 
            margin-bottom: 15px; 
            cursor: pointer; 
        }
        
        .workout-folder h3 {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .check-in-btn { 
            background-color: var(--accent-red); 
            color: white; 
            border: none; 
            border-radius: 5px; 
            padding: 8px 15px; 
            font-weight: 600; 
            cursor: pointer; 
            transition: background-color 0.3s; 
        }
        
        .check-in-btn.checked { 
            background-color: var(--accent-green); 
        }
        
        .workout-details { 
            margin-top: 15px; 
            display: none; 
        }
        
        .workout-details.active { 
            display: block; 
        }
        
        .exercise-item { 
            border-bottom: 1px solid var(--border-color); 
            display: flex; 
            align-items: center; 
            padding: 15px 0; 
        }
        
        .exercise-item:last-child { 
            border-bottom: none; 
        }
        
        .exercise-item img { 
            width: 60px; 
            height: 60px; 
            border-radius: 8px; 
            object-fit: cover; 
            margin-right: 15px; 
            flex-shrink: 0; 
            background-color: #eee; 
        }
        
        .exercise-info { 
            flex: 1; 
        }
        
        .exercise-info h4 { 
            color: var(--text-primary); 
            margin-bottom: 4px; 
        }
        
        .exercise-info p { 
            color: var(--text-secondary); 
            font-size: 0.9rem; 
        }
        
        .exercise-check {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .check-btn {
            width: 24px;
            height: 24px;
            border: 2px solid #ddd;
            border-radius: 50%;
            background: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .check-btn.checked {
            background-color: var(--accent-green);
            border-color: var(--accent-green);
            color: white;
        }
        
        .calendar-controls { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 15px; 
        }
        
        .calendar-controls button { 
            background: none; 
            border: none; 
            font-size: 1.5rem; 
            cursor: pointer; 
            color: var(--text-primary); 
        }
        
        #current-month-year, #workout-calendar-month-year { 
            font-size: 1.2rem; 
            font-weight: 600; 
            color: var(--text-primary); 
        }
        
        .calendar-grid { 
            display: grid; 
            grid-template-columns: repeat(7, 1fr); 
            gap: 5px; 
        }
        
        .calendar-header-day { 
            text-align: center; 
            font-weight: 600; 
            color: var(--text-secondary); 
            padding-bottom: 10px; 
        }
        
        .calendar-day { 
            aspect-ratio: 1; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            border-radius: 8px; 
            background-color: var(--bg-secondary); 
            font-size: 0.8rem; 
            position: relative; 
            border: 1px solid var(--border-color); 
        }
        
        .calendar-day.other-month { 
            background-color: #fafafa; 
            color: #ccc; 
        }
        
        .calendar-day.today .day-number { 
            color: var(--accent-red); 
            font-weight: bold; 
        }
        
        .calendar-day .day-workout-type { 
            font-weight: 600; 
            margin-top: 2px; 
            font-size: 0.7rem;
        }
        
        .calendar-day.scheduled { 
            background-color: #fff3e0; 
        }
        
        .calendar-day.scheduled .day-workout-type { 
            color: #e65100; 
        }
        
        .calendar-day.checked { 
            background-color: #e8f5e9; 
        }
        
        .calendar-day.checked .day-workout-type { 
            color: var(--accent-green); 
        }
        
        .calendar-day.partial { 
            background-color: #ffecb3; 
        }
        
        .calendar-day.partial .day-workout-type { 
            color: var(--accent-orange); 
        }
        
        .calendar-day.missed { 
            background-color: #ffcdd2; 
        }
        
        .calendar-day.missed .day-workout-type { 
            color: var(--accent-red); 
            text-decoration: line-through; 
        }
        
        .day-number { 
            font-weight: bold; 
        }
        
        .periodization-table { 
            width: 100%; 
            border-collapse: collapse; 
            margin-top: 15px; 
            font-size: 0.8rem; 
        }
        
        .periodization-table th, .periodization-table td { 
            border: 1px solid var(--border-color); 
            padding: 10px; 
            text-align: left; 
        }
        
        .periodization-table th { 
            background-color: var(--bg-secondary); 
        }
        
        .running-plan { 
            display: flex; 
            flex-direction: column; 
            gap: 15px; 
        }
        
        .running-session { 
            background-color: #eff6ff; 
            border-left: 4px solid #3b82f6; 
            padding: 15px; 
            border-radius: 5px; 
            cursor: pointer; 
        }
        
        .running-session.next {
            background-color: #e8f5e9;
            border-left-color: var(--accent-green);
        }
        
        .running-details {
            display: none;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid var(--border-color);
        }
        
        .running-details.active {
            display: block;
        }
        
        .stats { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); 
            gap: 10px; 
            margin-top: 15px; 
        }
        
        .stat-card { 
            background-color: var(--bg-secondary); 
            padding: 15px; 
            border-radius: 5px; 
            text-align: center; 
        }
        
        .stat-value { 
            font-size: 1.5rem; 
            font-weight: bold; 
            color: var(--accent-red); 
        }
        
        .stat-label { 
            font-size: 0.8rem; 
            color: var(--text-secondary); 
        }
        
        .modal { 
            display: none; 
            position: fixed; 
            z-index: 2000; 
            left: 0; 
            top: 0; 
            width: 100%; 
            height: 100%; 
            overflow: auto; 
            background-color: rgba(0,0,0,0.5); 
            animation: fadeIn 0.3s; 
        }
        
        .modal-content { 
            background-color: var(--bg-primary); 
            margin: 15% auto; 
            padding: 25px; 
            border: 1px solid #ccc; 
            border-radius: 10px; 
            width: 90%; 
            max-width: 500px; 
            position: relative; 
        }
        
        .close-btn { 
            color: #aaa; 
            position: absolute; 
            top: 10px; 
            right: 20px; 
            font-size: 28px; 
            font-weight: bold; 
        }
        
        .close-btn:hover, .close-btn:focus { 
            color: var(--text-primary); 
            text-decoration: none; 
            cursor: pointer; 
        }
        
        #modal-run-details p { 
            margin-bottom: 10px; 
        }
        
        #modal-run-details p strong { 
            color: var(--text-secondary); 
        }
        
        /* Estilo para a logo AB Fit */
        .logo-text {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--accent-red);
            margin-bottom: 20px;
        }
        
        .logo-text span:first-child {
            color: var(--accent-red);
        }
        
        .logo-text span:last-child {
            color: var(--text-primary);
        }
    </style>
</head>
<body>
    <!-- Tela de Login -->
    <div class="login-screen" id="loginScreen">
        <div class="login-container">
            <div class="logo-text">
                <span>AB</span><span>Fit</span>
            </div>
            <p class="login-prompt">Selecione seu perfil para acessar</p>
            
            <div class="user-selection" id="userSelection">
                <!-- Os usuários serão carregados via JavaScript -->
            </div>
        </div>
    </div>
    
    <!-- Tela Principal -->
    <div class="main-screen" id="mainScreen">
        <header>
            <div class="user-info">
                <img id="headerUserPhoto" src="" alt="Usuário">
                <span id="headerUserName">Usuário</span>
            </div>
            <button class="logout-btn" id="logoutBtn">
                <i class="fas fa-sign-out-alt"></i>
            </button>
        </header>
        
        <div class="main-content">
            <div class="tab-navigation">
                <button class="tab-button active" data-tab="workout">Treino</button>
                <button class="tab-button" data-tab="periodization">Periodização</button>
                <button class="tab-button" data-tab="running">Corrida</button>
                <button class="tab-button" data-tab="calendar">Calendário</button>
            </div>
            
            <div id="workout-tab" class="tab-content active">
                <div class="card">
                    <h2><i class="fas fa-dumbbell"></i> Meus Treinos</h2>
                    
                    <div class="workout-folder">
                        <h3>
                            <span><i class="fas fa-folder"></i> Treino A</span>
                            <button class="check-in-btn" id="checkInA">Check-in A</button>
                        </h3>
                        <div class="workout-details" id="workoutA-details">
                            <!-- Exercícios do Treino A serão carregados aqui -->
                        </div>
                    </div>
                    
                    <div class="workout-folder">
                        <h3>
                            <span><i class="fas fa-folder"></i> Treino B</span>
                            <button class="check-in-btn" id="checkInB">Check-in B</button>
                        </h3>
                        <div class="workout-details" id="workoutB-details">
                            <!-- Exercícios do Treino B serão carregados aqui -->
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <h2><i class="fas fa-chart-line"></i> Estatísticas</h2>
                    <div class="stats">
                        <div class="stat-card">
                            <div class="stat-value" id="workouts-done">0</div>
                            <div class="stat-label">Treinos Realizados</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="workouts-missed">0</div>
                            <div class="stat-label">Treinos Perdidos</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="attendance-rate">0%</div>
                            <div class="stat-label">Taxa de Presença</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" id="last-workout">-</div>
                            <div class="stat-label">Último Treino</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="periodization-tab" class="tab-content">
                <div class="card">
                    <h2><i class="fas fa-calendar-week"></i> Periodização</h2>
                    <div id="periodization-table">
                        <!-- A tabela de periodização será carregada via JavaScript -->
                    </div>
                </div>
            </div>
            
            <div id="running-tab" class="tab-content">
                <div class="card">
                    <h2><i class="fas fa-running"></i> Próximo Treino de Corrida</h2>
                    <div id="next-running">
                        <!-- O próximo treino de corrida será carregado via JavaScript -->
                    </div>
                </div>
                
                <div class="card">
                    <h2><i class="fas fa-list-alt"></i> Planilha de Corrida</h2>
                    <div class="running-plan" id="running-plan">
                        <!-- A planilha de corrida será carregada via JavaScript -->
                    </div>
                </div>
            </div>
            
            <div id="calendar-tab" class="tab-content">
                <div class="card">
                    <h2><i class="fas fa-calendar"></i> Calendário de Treinos</h2>
                    <div id="calendar">
                        <!-- O calendário será carregado via JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Dados dos usuários
        const users = [
            {
                name: "André Brito",
                email: "britodeandrade@gmail.com",
                photo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/WsTwhcQeE99iAkUHmCmn/pub/3Zy4n6ZmWp9DW98VtXpO.jpeg",
                age: 36,
                maxHR: 184,
                lastWorkoutDate: "27/9",
                lastWorkoutNumber: 5,
                nextWorkoutDate: "30/09/2025, 12:00:00",
                nextWorkoutMethod: "FARTLEK",
                loginCode: "AND"
            },
            {
                name: "Marcelly Bispo",
                email: "marcellybispo92@gmail.com",
                photo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/WsTwhcQeE99iAkUHmCmn/pub/2VWhNV4eSyDNkwEzPGvq.jpeg",
                age: 33,
                maxHR: 187,
                lastWorkoutDate: "19/9",
                lastWorkoutNumber: 5,
                nextWorkoutDate: "22/09/2025, 12:00:00",
                nextWorkoutMethod: "FARTLEK",
                loginCode: "MAR"
            },
            {
                name: "Marcia Brito",
                email: "andrademarcia.ucam@gmail.com",
                photo: "https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/WsTwhcQeE99iAkUHmCmn/pub/huS3I3wDTHbXGY1EuLjf.jpg",
                age: 59,
                maxHR: 161,
                loginCode: "MAR"
            },
            {
                name: "Liliane Torres",
                email: "lilicatorres@gmail.com",
                photo: "",
                age: null,
                loginCode: "LIL"
            }
        ];

        // Dados de treinos
        const workouts = {
            "britodeandrade@gmail.com": {
                A: [
                    { exercise: "Agachamento parcial no Smith", series: 4, reps: 10, load: 15, method: "Método Simples (10 RM)", recovery: "30s" },
                    { exercise: "Agachamento Livre com HBC", series: 4, reps: 10, load: 14, method: "Método Simples (10 RM)", recovery: "30s" },
                    { exercise: "Cadeira extensora", series: 4, reps: 10, load: 3, method: "Método Simples (10 RM)", recovery: "30s" },
                    { exercise: "Supino inclinado com HBC", series: 3, reps: 10, load: 12, method: "Método Simples (10 RM)", recovery: "30s" },
                    { exercise: "Extensão de cotovelos no solo", series: 3, reps: 10, load: 0, method: "Método Simples (10 RM)", recovery: "30s" }
                ],
                B: [
                    { exercise: "Agachamento sumô com HBC", series: 4, reps: 10, load: 22, method: "Método Simples (10 RM)", recovery: "30s" },
                    { exercise: "Stiff em pé com HBM", series: 4, reps: 10, load: 14, method: "Método Simples (10 RM)", recovery: "30s" },
                    { exercise: "Extensão de quadril com caneleira", series: 4, reps: 10, load: 7, method: "Método Simples (10 RM)", recovery: "30s" },
                    { exercise: "Remada curvada aberta com HBC", series: 3, reps: 10, load: 8, method: "Método Simples (10 RM)", recovery: "30s" },
                    { exercise: "Crucifixo inverso curvado com HBC", series: 3, reps: 10, load: 4, method: "Método Simples (10 RM)", recovery: "30s" }
                ]
            },
            "marcellybispo92@gmail.com": {
                A: [
                    { exercise: "Agachamento Livre", series: 3, reps: 20, method: "Método Simples (20 RM)", recovery: "30s" },
                    { exercise: "Agachamento Livre em isometria", series: 3, reps: 20, method: "Método Simples (20 RM)", recovery: "30s" },
                    { exercise: "Agachamento Livre com HBC", series: 4, reps: 10, method: "Método Simples (10 RM)", recovery: "30s" },
                    { exercise: "Agachamento em passada com HBC", series: 3, reps: 10, method: "Método Simples (10 RM)", recovery: "30s" },
                    { exercise: "Cadeira extensora", series: 3, reps: 10, method: "Método Simples (10 RM)", recovery: "30s" }
                ],
                B: [
                    { exercise: "Agachamento sumô com HBC", series: 4, reps: 10, method: "Método Simples (10 RM)", recovery: "30s" },
                    { exercise: "Stiff em pé com HBM", series: 4, reps: 10, method: "Método Simples (10 RM)", recovery: "30s" },
                    { exercise: "Extensão de quadril com caneleira", series: 4, reps: 10, method: "Método Simples (10 RM)", recovery: "30s" },
                    { exercise: "Remada aberta na máquina", series: 3, reps: 10, method: "Método Simples (10 RM)", recovery: "30s" },
                    { exercise: "Crucifixo inverso com HBC", series: 3, reps: 10, method: "Método Simples (10 RM)", recovery: "30s" }
                ]
            }
        };

        // Dados de corrida
        const runningPlans = {
            "britodeandrade@gmail.com": [
                { date: "30/09/2025", number: 1, method: "FARTLEK", targetHR: "147,2", pace: "7:00", duration: "30min", details: "5' AQ + 20' CO alternado entre CA : CO + 5' REC" },
                { date: "01/10/2025", number: 2, method: "INTERVALADO", targetHR: "156,4", pace: "6:19", duration: "30min", details: "5' AQ + (6 BLOCOS) 2' CO : 1'30'' REC + 3' REC" },
                { date: "03/10/2025", number: 3, method: "LONGÃO", targetHR: "147,2", pace: "7:04", duration: "30min", details: "5' AQ + 3 KM DE CO CONTÍNUA + 5' REC" }
            ],
            "marcellybispo92@gmail.com": [
                { date: "22/09/2025", number: 1, method: "FARTLEK", targetHR: "149,6", pace: "8:00", duration: "30min", details: "5' AQ + 20' CO alternado entre CA : CO + 5' REC" },
                { date: "24/09/2025", number: 2, method: "INTERVALADO", targetHR: "158,95", pace: "7:04", duration: "30min", details: "5' AQ + (6 BLOCOS) 2' CO : 1'30'' REC + 3' REC" },
                { date: "26/09/2025", number: 3, method: "LONGÃO", targetHR: "149,6", pace: "7:30", duration: "30min", details: "5' AQ + 3 KM DE CO CONTÍNUA + 5' REC" }
            ]
        };

        // Dados de periodização
        const periodizations = {
            "britodeandrade@gmail.com": [
                { weeks: "1ª e 2ª", phase: "Adaptação/Hipertrofia", method: "Método de execução Simples", reps: "10", volume: "16 séries/grupo", intensity: "70-75% 1RM", recovery: "60-90s" },
                { weeks: "3ª e 4ª", phase: "Adaptação/Hipertrofia", method: "Método de execução Simples", reps: "8-9", volume: "16 séries/grupo", intensity: "70-75% 1RM", recovery: "60-90s" },
                { weeks: "5ª e 6ª", phase: "Força", method: "Método de execução Simples + Rest-Pause", reps: "6-7", volume: "14 séries/grupo", intensity: "80-85% 1RM", recovery: "90-120s" }
            ],
            "marcellybispo92@gmail.com": [
                { weeks: "1ª e 2ª", phase: "Adaptação/Hipertrofia", method: "Método de execução Simples", reps: "10", volume: "16 séries/grupo", intensity: "70-75% 1RM", recovery: "60-90s" },
                { weeks: "3ª e 4ª", phase: "Adaptação/Hipertrofia", method: "Método de execução Simples", reps: "8-9", volume: "16 séries/grupo", intensity: "70-75% 1RM", recovery: "60-90s" },
                { weeks: "5ª e 6ª", phase: "Força", method: "Método de execução Simples + Rest-Pause", reps: "6-7", volume: "14 séries/grupo", intensity: "80-85% 1RM", recovery: "90-120s" }
            ]
        };

        // Estado da aplicação
        let currentUser = null;
        let workoutHistory = JSON.parse(localStorage.getItem('workoutHistory')) || {};
        let exerciseCompletion = JSON.parse(localStorage.getItem('exerciseCompletion')) || {};

        // Inicialização da aplicação
        document.addEventListener('DOMContentLoaded', function() {
            renderUserSelection();
            setupTabNavigation();
            setupLogoutButton();
        });

        // Renderizar seleção de usuários na tela de login
        function renderUserSelection() {
            const userSelection = document.getElementById('userSelection');
            userSelection.innerHTML = '';
            
            users.forEach(user => {
                const userOption = document.createElement('div');
                userOption.className = 'user-option';
                userOption.innerHTML = `
                    <img src="${user.photo || 'https://via.placeholder.com/80'}" alt="${user.name}" class="user-photo">
                    <span class="user-name">${user.name}</span>
                `;
                userOption.addEventListener('click', () => {
                    loginUser(user);
                });
                userSelection.appendChild(userOption);
            });
        }

        // Fazer login do usuário
        function loginUser(user) {
            currentUser = user;
            
            // Mostrar tela principal e esconder tela de login
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('mainScreen').style.display = 'block';
            
            // Atualizar header com informações do usuário
            document.getElementById('headerUserPhoto').src = user.photo || 'https://via.placeholder.com/40';
            document.getElementById('headerUserName').textContent = user.name;
            
            // Carregar dados do usuário
            loadUserData(user);
        }

        // Configurar botão de logout
        function setupLogoutButton() {
            const logoutBtn = document.getElementById('logoutBtn');
            logoutBtn.addEventListener('click', function() {
                currentUser = null;
                document.getElementById('mainScreen').style.display = 'none';
                document.getElementById('loginScreen').style.display = 'flex';
            });
        }

        // Configurar navegação por abas
        function setupTabNavigation() {
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabId = button.getAttribute('data-tab');
                    
                    // Ativar botão da aba
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    
                    // Mostrar conteúdo da aba
                    tabContents.forEach(content => content.classList.remove('active'));
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });
        }

        // Carregar dados do usuário selecionado
        function loadUserData(user) {
            loadWorkoutTab(user);
            loadRunningTab(user);
            loadPeriodizationTab(user);
            loadCalendarTab(user);
        }

        // Carregar aba de treino
        function loadWorkoutTab(user) {
            const userWorkouts = workouts[user.email];
            
            if (userWorkouts) {
                // Configurar botões de check-in
                setupCheckInButtons(user);
                
                // Carregar exercícios do Treino A
                loadWorkoutExercises('A', userWorkouts.A, user);
                
                // Carregar exercícios do Treino B
                loadWorkoutExercises('B', userWorkouts.B, user);
            } else {
                document.getElementById('workoutA-details').innerHTML = '<p>Nenhum treino cadastrado para este usuário.</p>';
                document.getElementById('workoutB-details').innerHTML = '<p>Nenhum treino cadastrado para este usuário.</p>';
            }
            
            updateStatistics(user.email);
        }

        // Configurar botões de check-in
        function setupCheckInButtons(user) {
            const checkInA = document.getElementById('checkInA');
            const checkInB = document.getElementById('checkInB');
            const workoutADetails = document.getElementById('workoutA-details');
            const workoutBDetails = document.getElementById('workoutB-details');
            
            // Alternar visibilidade dos detalhes do treino
            checkInA.parentElement.parentElement.addEventListener('click', function(e) {
                if (e.target !== checkInA) {
                    workoutADetails.classList.toggle('active');
                    workoutBDetails.classList.remove('active');
                }
            });
            
            checkInB.parentElement.parentElement.addEventListener('click', function(e) {
                if (e.target !== checkInB) {
                    workoutBDetails.classList.toggle('active');
                    workoutADetails.classList.remove('active');
                }
            });
            
            // Check-in para Treino A
            checkInA.addEventListener('click', function(e) {
                e.stopPropagation();
                const today = new Date().toISOString().split('T')[0];
                recordWorkout(user.email, 'A', today, 'full');
                this.classList.add('checked');
                this.textContent = 'Concluído';
                this.disabled = true;
                updateStatistics(user.email);
                loadCalendarTab(user);
            });
            
            // Check-in para Treino B
            checkInB.addEventListener('click', function(e) {
                e.stopPropagation();
                const today = new Date().toISOString().split('T')[0];
                recordWorkout(user.email, 'B', today, 'full');
                this.classList.add('checked');
                this.textContent = 'Concluído';
                this.disabled = true;
                updateStatistics(user.email);
                loadCalendarTab(user);
            });
            
            // Verificar se já fez check-in hoje
            const today = new Date().toISOString().split('T')[0];
            if (workoutHistory[user.email] && workoutHistory[user.email][today]) {
                const todayWorkout = workoutHistory[user.email][today];
                if (todayWorkout.type === 'A') {
                    checkInA.classList.add('checked');
                    checkInA.textContent = 'Concluído';
                    checkInA.disabled = true;
                } else if (todayWorkout.type === 'B') {
                    checkInB.classList.add('checked');
                    checkInB.textContent = 'Concluído';
                    checkInB.disabled = true;
                }
            }
        }

        // Carregar exercícios de um treino
        function loadWorkoutExercises(type, exercises, user) {
            const workoutDetails = document.getElementById(`workout${type}-details`);
            let exercisesHTML = '';
            
            exercises.forEach((exercise, index) => {
                const exerciseId = `${user.email}-${type}-${index}`;
                const isChecked = exerciseCompletion[exerciseId] || false;
                
                exercisesHTML += `
                <div class="exercise-item">
                    <div class="exercise-info">
                        <h4>${index + 1}. ${exercise.exercise}</h4>
                        <p>${exercise.series} séries de ${exercise.reps} repetições</p>
                        ${exercise.load ? `<p>Carga: ${exercise.load}kg</p>` : ''}
                        <p>Método: ${exercise.method} | Recuperação: ${exercise.recovery}</p>
                    </div>
                    <div class="exercise-check">
                        <button class="check-btn ${isChecked ? 'checked' : ''}" data-exercise="${exerciseId}">
                            ${isChecked ? '<i class="fas fa-check"></i>' : ''}
                        </button>
                    </div>
                </div>
                `;
            });
            
            workoutDetails.innerHTML = exercisesHTML;
            
            // Adicionar event listeners aos botões de check dos exercícios
            workoutDetails.querySelectorAll('.check-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const exerciseId = this.getAttribute('data-exercise');
                    const isChecked = !exerciseCompletion[exerciseId];
                    
                    exerciseCompletion[exerciseId] = isChecked;
                    localStorage.setItem('exerciseCompletion', JSON.stringify(exerciseCompletion));
                    
                    this.classList.toggle('checked');
                    this.innerHTML = isChecked ? '<i class="fas fa-check"></i>' : '';
                    
                    // Verificar se todos os exercícios foram completados
                    checkWorkoutCompletion(user.email, type, exercises.length);
                });
            });
        }

        // Verificar se todos os exercícios de um treino foram completados
        function checkWorkoutCompletion(email, type, totalExercises) {
            let completedExercises = 0;
            
            for (let i = 0; i < totalExercises; i++) {
                const exerciseId = `${email}-${type}-${i}`;
                if (exerciseCompletion[exerciseId]) {
                    completedExercises++;
                }
            }
            
            // Se todos os exercícios foram completados, fazer check-in automático
            if (completedExercises === totalExercises) {
                const today = new Date().toISOString().split('T')[0];
                recordWorkout(email, type, today, 'full');
                updateStatistics(email);
                loadCalendarTab(currentUser);
                
                // Atualizar botão de check-in
                const checkInBtn = document.getElementById(`checkIn${type}`);
                checkInBtn.classList.add('checked');
                checkInBtn.textContent = 'Concluído';
                checkInBtn.disabled = true;
            } else if (completedExercises > 0) {
                // Se alguns exercícios foram completados, marcar como parcial
                const today = new Date().toISOString().split('T')[0];
                if (!workoutHistory[email] || !workoutHistory[email][today]) {
                    recordWorkout(email, type, today, 'partial');
                    updateStatistics(email);
                    loadCalendarTab(currentUser);
                }
            }
        }

        // Carregar aba de corrida
        function loadRunningTab(user) {
            const nextRunning = document.getElementById('next-running');
            const runningPlan = document.getElementById('running-plan');
            const userRunningPlan = runningPlans[user.email];
            
            if (userRunningPlan && userRunningPlan.length > 0) {
                // Próximo treino de corrida
                const nextSession = userRunningPlan[0];
                nextRunning.innerHTML = `
                    <div class="running-session next">
                        <h3>Treino ${nextSession.number} - ${nextSession.method} <span class="date">${nextSession.date}</span></h3>
                        <p><strong>FC Alvo:</strong> ${nextSession.targetHR} BPM</p>
                        <p><strong>Pace:</strong> ${nextSession.pace} min/km</p>
                        <p><strong>Duração:</strong> ${nextSession.duration}</p>
                        <div class="running-details">
                            <p><strong>Detalhes:</strong> ${nextSession.details}</p>
                        </div>
                    </div>
                `;
                
                // Planilha completa de corrida
                runningPlan.innerHTML = '';
                userRunningPlan.forEach(session => {
                    const sessionHTML = `
                    <div class="running-session">
                        <h3>Treino ${session.number} - ${session.method} <span class="date">${session.date}</span></h3>
                        <p><strong>FC Alvo:</strong> ${session.targetHR} BPM</p>
                        <p><strong>Pace:</strong> ${session.pace} min/km</p>
                        <p><strong>Duração:</strong> ${session.duration}</p>
                        <div class="running-details">
                            <p><strong>Detalhes:</strong> ${session.details}</p>
                        </div>
                    </div>
                    `;
                    runningPlan.innerHTML += sessionHTML;
                });
                
                // Adicionar event listeners para mostrar/ocultar detalhes
                document.querySelectorAll('.running-session').forEach(session => {
                    session.addEventListener('click', function() {
                        const details = this.querySelector('.running-details');
                        details.classList.toggle('active');
                    });
                });
            } else {
                nextRunning.innerHTML = '<p>Nenhum treino de corrida cadastrado.</p>';
                runningPlan.innerHTML = '<p>Nenhum treino de corrida cadastrado.</p>';
            }
        }

        // Carregar aba de periodização
        function loadPeriodizationTab(user) {
            const periodizationTable = document.getElementById('periodization-table');
            const userPeriodization = periodizations[user.email];
            
            if (userPeriodization) {
                let tableHTML = `
                <table class="periodization-table">
                    <thead>
                        <tr>
                            <th>Semanas</th>
                            <th>Fases</th>
                            <th>Métodos</th>
                            <th>Repetições</th>
                            <th>Volume</th>
                            <th>Intensidade</th>
                            <th>Recuperação</th>
                        </tr>
                    </thead>
                    <tbody>
                `;
                
                userPeriodization.forEach(phase => {
                    tableHTML += `
                    <tr>
                        <td>${phase.weeks}</td>
                        <td>${phase.phase}</td>
                        <td>${phase.method}</td>
                        <td>${phase.reps}</td>
                        <td>${phase.volume}</td>
                        <td>${phase.intensity}</td>
                        <td>${phase.recovery}</td>
                    </tr>
                    `;
                });
                
                tableHTML += '</tbody></table>';
                periodizationTable.innerHTML = tableHTML;
            } else {
                periodizationTable.innerHTML = '<p>Nenhuma periodização cadastrada para este usuário.</p>';
            }
        }

        // Carregar aba de calendário
        function loadCalendarTab(user) {
            const calendar = document.getElementById('calendar');
            const today = new Date();
            const year = today.getFullYear();
            const month = today.getMonth();
            
            // Criar cabeçalho do calendário
            let calendarHTML = `
            <div class="calendar-grid">
                <div class="calendar-header-day">Dom</div>
                <div class="calendar-header-day">Seg</div>
                <div class="calendar-header-day">Ter</div>
                <div class="calendar-header-day">Qua</div>
                <div class="calendar-header-day">Qui</div>
                <div class="calendar-header-day">Sex</div>
                <div class="calendar-header-day">Sáb</div>
            `;
            
            // Primeiro dia do mês
            const firstDay = new Date(year, month, 1);
            // Último dia do mês
            const lastDay = new Date(year, month + 1, 0);
            // Dia da semana do primeiro dia (0 = Domingo, 1 = Segunda, etc.)
            const firstDayOfWeek = firstDay.getDay();
            
            // Dias vazios no início do mês
            for (let i = 0; i < firstDayOfWeek; i++) {
                calendarHTML += '<div class="calendar-day other-month"></div>';
            }
            
            // Dias do mês
            for (let day = 1; day <= lastDay.getDate(); day++) {
                const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const isToday = day === today.getDate() && month === today.getMonth() && year === today.getFullYear();
                const hasWorkout = workoutHistory[user.email] && workoutHistory[user.email][dateStr];
                
                let dayClass = 'calendar-day';
                let workoutType = day % 2 === 0 ? 'A' : 'B';
                let dayStatus = '';
                
                if (isToday) dayClass += ' today';
                
                if (hasWorkout) {
                    if (hasWorkout.status === 'full') {
                        dayClass += ' checked';
                        dayStatus = 'Completo';
                    } else if (hasWorkout.status === 'partial') {
                        dayClass += ' partial';
                        dayStatus = 'Parcial';
                    }
                } else {
                    dayClass += ' scheduled';
                    dayStatus = `Treino ${workoutType}`;
                    
                    // Verificar se é um dia que já passou e não foi feito check-in
                    const dayDate = new Date(year, month, day);
                    if (dayDate < today && dayDate.getDate() !== today.getDate()) {
                        dayClass += ' missed';
                        dayStatus = 'Faltou';
                    }
                }
                
                calendarHTML += `
                <div class="${dayClass}">
                    <div class="day-number">${day}</div>
                    <div class="day-workout-type">${dayStatus}</div>
                </div>`;
            }
            
            calendarHTML += '</div>';
            calendar.innerHTML = calendarHTML;
        }

        // Registrar treino realizado
        function recordWorkout(email, type, date, status) {
            if (!workoutHistory[email]) {
                workoutHistory[email] = {};
            }
            
            workoutHistory[email][date] = {
                type: type,
                status: status,
                timestamp: new Date().toISOString()
            };
            
            localStorage.setItem('workoutHistory', JSON.stringify(workoutHistory));
        }

        // Atualizar estatísticas
        function updateStatistics(email) {
            const workoutsDone = document.getElementById('workouts-done');
            const workoutsMissed = document.getElementById('workouts-missed');
            const attendanceRate = document.getElementById('attendance-rate');
            const lastWorkout = document.getElementById('last-workout');
            
            const userHistory = workoutHistory[email] || {};
            const workoutDates = Object.keys(userHistory);
            const totalWorkouts = workoutDates.length;
            
            // Calcular dias de treino previstos (simplificado)
            const today = new Date();
            const startOfMonth = new Date(today.getFullYear(), today.getMonth(), 1);
            const daysInMonth = new Date(today.getFullYear(), today.getMonth() + 1, 0).getDate();
            const daysSoFar = today.getDate();
            const expectedWorkouts = Math.floor(daysSoFar / 2); // Simplificação: treino a cada 2 dias
            
            workoutsDone.textContent = totalWorkouts;
            workoutsMissed.textContent = Math.max(0, expectedWorkouts - totalWorkouts);
            
            if (expectedWorkouts > 0) {
                const rate = Math.round((totalWorkouts / expectedWorkouts) * 100);
                attendanceRate.textContent = `${rate}%`;
            } else {
                attendanceRate.textContent = '0%';
            }
            
            if (workoutDates.length > 0) {
                const lastDate = new Date(Math.max(...workoutDates.map(d => new Date(d))));
                lastWorkout.textContent = lastDate.toLocaleDateString('pt-BR');
            } else {
                lastWorkout.textContent = '-';
            }
        }
    </script>
</body>
</html>
